<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>如何使用 docker 在 Mac 上运行并配置 Ubuntu | Southern</title>
<meta name=keywords content><meta name=description content="背景
我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。
我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：

校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。
学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。

看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。
最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。
下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。
安装 Docker Desktop for Mac
访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。
下载并运行 Ubuntu 镜像
在终端中输入以下命令来拉取 Ubuntu 镜像：
docker pull --platform linux/amd64 ubuntu
我使用 &ndash;platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。"><meta name=author content="Me"><link rel=canonical href=http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/"><meta property="og:site_name" content="Southern"><meta property="og:title" content="如何使用 docker 在 Mac 上运行并配置 Ubuntu"><meta property="og:description" content="背景 我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。
我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：
校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。 学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。 看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。
最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。
下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。
安装 Docker Desktop for Mac 访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。
下载并运行 Ubuntu 镜像 在终端中输入以下命令来拉取 Ubuntu 镜像：
docker pull --platform linux/amd64 ubuntu 我使用 –platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-12-20T00:00:00+08:00"><meta property="article:modified_time" content="2024-12-20T00:00:00+08:00"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="如何使用 docker 在 Mac 上运行并配置 Ubuntu"><meta name=twitter:description content="背景
我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。
我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：

校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。
学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。

看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。
最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。
下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。
安装 Docker Desktop for Mac
访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。
下载并运行 Ubuntu 镜像
在终端中输入以下命令来拉取 Ubuntu 镜像：
docker pull --platform linux/amd64 ubuntu
我使用 &ndash;platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","item":"http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","name":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","description":"背景 我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。\n我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：\n校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。 学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。 看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。\n最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。\n下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。\n安装 Docker Desktop for Mac 访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。\n下载并运行 Ubuntu 镜像 在终端中输入以下命令来拉取 Ubuntu 镜像：\ndocker pull --platform linux/amd64 ubuntu 我使用 \u0026ndash;platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。\n","keywords":[],"articleBody":"背景 我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。\n我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：\n校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。 学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。 看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。\n最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。\n下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。\n安装 Docker Desktop for Mac 访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。\n下载并运行 Ubuntu 镜像 在终端中输入以下命令来拉取 Ubuntu 镜像：\ndocker pull --platform linux/amd64 ubuntu 我使用 –platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。\n拉取完成后，运行以下命令来启动一个新的 Ubuntu 容器：\ndocker run --platform linux/amd64 -it ubuntu /bin/bash 这个命令会启动一个新的 Ubuntu 容器，并且进入 bash shell。不过，这个容器还是一个全新的、仅包含最基本软件的 Ubuntu 系统，它看起来应该是这样的：\nwood@Woods-MacBook-Pro ~\u003e docker exec -it ubuntu bash root@8d907eeb-----:/# 如果需要退出容器，使用 exit 命令。\n如果要重新进入容器，可以使用 docker ps -a 查看容器的 ID，然后使用 docker start 和 docker attach 命令。\n我们首先应该要新建一个用户，因为 root 用户不应该用于日常操作。在容器中依次以下命令：\napt update apt install sudo adduser adduser 在按照提示设置密码和其他信息后，我们需要将新建的用户加入 sudo 组：\n如果你在 apt update 时遇到了网络问题，可以尝试更换软件源，或者使用代理（参看代理 Docker 容器）。\nusermod -aG sudo 使用 su 命令切换到新建的用户，并测试一下 sudo 是否正常工作：\nsu - sudo whoami 如果输出为 root，则说明 sudo 已经正常工作。\nDocker 快捷命令 在继续配置 Ubuntu 容器之前，我想先让启动和退出容器更加方便。\n首先使用 docker ps -a 查看容器的 ID，然后使用 docker rename ubuntu 命令为容器设置别名为 ubuntu。\n随后，我在 ~/.config/fish/config.fish 中添加了以下两个 alias：\nalias ubuntu 'docker start ubuntu \u0026\u0026 docker attach ubuntu' alias ubuntu-stop 'docker stop ubuntu' 运行 source ~/.config/fish/config.fish 使配置生效。\nps: 如果你使用的是 bash，可以将 alias 添加到 ~/.bashrc 中，并运行 source ~/.bashrc，注意，bash 的 alias 语法和 fish 有所不同，需要使用一个 = 号：alias ubuntu='docker start ubuntu \u0026\u0026 docker attach ubuntu'。\n配置 Ubuntu 容器 fish shell 我习惯使用 fish shell，并以 fish 为默认 shell。在容器中，我首先安装了 fish shell：\nsudo apt install fish 我没有使用 chsh 命令来更改默认 shell，而是直接修改了对 ubuntu 命令的 alias：\nalias ubuntu \"docker start ubuntu \u0026\u0026 docker exec -it --user ubuntu fish -C 'cd ~'\" 这样，每次进入容器时，都会以普通用户的身份进入 fish shell，并且进入到用户目录。\n到这里，我已经接近了日常使用 Ubuntu 的体验。\nscreenfetch 我喜欢登陆时看到 screenfetch，如果诚实地说，是因为这满足了我小时候对“黑客”的幻想。\n我需要在 Docker 容器中安装 screenfetch，然后在 fish 的配置文件中添加 screenfetch 命令。\nsudo apt install screenfetch echo \"screenfetch 2\u003e/dev/null\" \u003e\u003e ~/.config/fish/config.fish 这里，因为 screenfetch 无法访问宿主机的信息，会显示一行错误信息，我希望过滤它，所以我在 screenfetch 命令后面加了一个 2\u003e/dev/null 来丢弃错误信息。\n我说，谁能拒绝一个 screenfetch 呢？\n","wordCount":"295","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-12-20T00:00:00+08:00","dateModified":"2024-12-20T00:00:00+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/"},"publisher":{"@type":"Organization","name":"Southern","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/post/>Posts</a></div><h1 class="post-title entry-hint-parent">如何使用 docker 在 Mac 上运行并配置 Ubuntu
<span class=entry-hint title=Draft><svg height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-meta><span title='2024-12-20 00:00:00 +0800 CST'>December 20, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;295 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/post/2024/12/Run-ubuntu-on-Mac-with-docker/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=背景>背景<a hidden class=anchor aria-hidden=true href=#背景>#</a></h2><p>我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。</p><p>我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：</p><ol><li>校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。</li><li>学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。</li></ol><p>看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。</p><p>最近，我关注的 up 主 <a href=https://space.bilibili.com/13081489>@TheCW</a> 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。</p><p>下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。</p><h2 id=安装-docker-desktop-for-mac>安装 Docker Desktop for Mac<a hidden class=anchor aria-hidden=true href=#安装-docker-desktop-for-mac>#</a></h2><p>访问 <a href=https://www.docker.com/products/docker-desktop>Docker 官网</a> 下载 Docker Desktop for Mac 即可，这部分不再赘述。</p><h2 id=下载并运行-ubuntu-镜像>下载并运行 Ubuntu 镜像<a hidden class=anchor aria-hidden=true href=#下载并运行-ubuntu-镜像>#</a></h2><p>在终端中输入以下命令来拉取 Ubuntu 镜像：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull --platform linux/amd64 ubuntu
</span></span></code></pre></div><p>我使用 &ndash;platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 <code>docker pull ubuntu</code>，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。</p><p>拉取完成后，运行以下命令来启动一个新的 Ubuntu 容器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --platform linux/amd64 -it ubuntu /bin/bash
</span></span></code></pre></div><p>这个命令会启动一个新的 Ubuntu 容器，并且进入 bash shell。不过，这个容器还是一个全新的、仅包含最基本软件的 Ubuntu 系统，它看起来应该是这样的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wood@Woods-MacBook-Pro ~&gt; docker <span class=nb>exec</span> -it ubuntu bash
</span></span><span class=line><span class=cl>root@8d907eeb-----:/# 
</span></span></code></pre></div><p>如果需要退出容器，使用 <code>exit</code> 命令。</p><p>如果要重新进入容器，可以使用 <code>docker ps -a</code> 查看容器的 ID，然后使用 <code>docker start &lt;container-id></code> 和 <code>docker attach &lt;container-id></code> 命令。</p><p>我们首先应该要新建一个用户，因为 root 用户不应该用于日常操作。在容器中依次以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt update
</span></span><span class=line><span class=cl>apt install sudo adduser
</span></span><span class=line><span class=cl>adduser &lt;your-username&gt;
</span></span></code></pre></div><p>在按照提示设置密码和其他信息后，我们需要将新建的用户加入 sudo 组：</p><p>如果你在 apt update 时遇到了网络问题，可以尝试更换软件源，或者使用代理（参看<a href=#%E4%BB%A3%E7%90%86-docker-%E5%AE%B9%E5%99%A8>代理 Docker 容器</a>）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>usermod -aG sudo &lt;your-username&gt;
</span></span></code></pre></div><p>使用 su 命令切换到新建的用户，并测试一下 sudo 是否正常工作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su - &lt;your-username&gt;
</span></span><span class=line><span class=cl>sudo whoami
</span></span></code></pre></div><p>如果输出为 <code>root</code>，则说明 sudo 已经正常工作。</p><h2 id=docker-快捷命令>Docker 快捷命令<a hidden class=anchor aria-hidden=true href=#docker-快捷命令>#</a></h2><p>在继续配置 Ubuntu 容器之前，我想先让启动和退出容器更加方便。</p><p>首先使用 <code>docker ps -a</code> 查看容器的 ID，然后使用 <code>docker rename &lt;container-id> ubuntu</code> 命令为容器设置别名为 ubuntu。</p><p>随后，我在 <code>~/.config/fish/config.fish</code> 中添加了以下两个 alias：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fish data-lang=fish><span class=line><span class=cl><span class=nb>alias </span>ubuntu <span class=s1>&#39;docker start ubuntu &amp;&amp; docker attach ubuntu&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias </span>ubuntu-stop <span class=s1>&#39;docker stop ubuntu&#39;</span>
</span></span></code></pre></div><p>运行 <code>source ~/.config/fish/config.fish</code> 使配置生效。</p><p>ps: 如果你使用的是 bash，可以将 alias 添加到 <code>~/.bashrc</code> 中，并运行 <code>source ~/.bashrc</code>，注意，bash 的 alias 语法和 fish 有所不同，需要使用一个 <code>=</code> 号：<code>alias ubuntu='docker start ubuntu && docker attach ubuntu'</code>。</p><h2 id=配置-ubuntu-容器>配置 Ubuntu 容器<a hidden class=anchor aria-hidden=true href=#配置-ubuntu-容器>#</a></h2><h3 id=fish-shell>fish shell<a hidden class=anchor aria-hidden=true href=#fish-shell>#</a></h3><p>我习惯使用 fish shell，并以 fish 为默认 shell。在容器中，我首先安装了 fish shell：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install fish
</span></span></code></pre></div><p>我没有使用 <code>chsh</code> 命令来更改默认 shell，而是直接修改了对 <code>ubuntu</code> 命令的 alias：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>alias</span> ubuntu <span class=s2>&#34;docker start ubuntu &amp;&amp; docker exec -it --user &lt;your-username&gt; ubuntu fish -C &#39;cd ~&#39;&#34;</span>
</span></span></code></pre></div><p>这样，每次进入容器时，都会以普通用户的身份进入 fish shell，并且进入到用户目录。</p><p>到这里，我已经接近了日常使用 Ubuntu 的体验。</p><h3 id=screenfetch>screenfetch<a hidden class=anchor aria-hidden=true href=#screenfetch>#</a></h3><p>我喜欢登陆时看到 screenfetch，如果诚实地说，是因为这满足了我小时候对“黑客”的幻想。</p><p>我需要在 Docker 容器中安装 screenfetch，然后在 fish 的配置文件中添加 screenfetch 命令。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install screenfetch
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;screenfetch 2&gt;/dev/null&#34;</span> &gt;&gt; ~/.config/fish/config.fish
</span></span></code></pre></div><p>这里，因为 screenfetch 无法访问宿主机的信息，会显示一行错误信息，我希望过滤它，所以我在 screenfetch 命令后面加了一个 <code>2>/dev/null</code> 来丢弃错误信息。</p><p>我说，谁能拒绝一个 screenfetch 呢？</p><p><img alt=screenfetch loading=lazy src=pic/screenfetch.png></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=http://localhost:1313/post/2024/12/changes-to-cs-from-ai/><span class=title>Next »</span><br><span>AI 时代，知识的价值</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on x" href="https://x.com/intent/tweet/?text=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f&amp;title=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu&amp;summary=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu&amp;source=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f&title=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on whatsapp" href="https://api.whatsapp.com/send?text=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu%20-%20http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on telegram" href="https://telegram.me/share/url?text=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu&amp;url=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 如何使用 docker 在 Mac 上运行并配置 Ubuntu on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%20docker%20%e5%9c%a8%20Mac%20%e4%b8%8a%e8%bf%90%e8%a1%8c%e5%b9%b6%e9%85%8d%e7%bd%ae%20Ubuntu&u=http%3a%2f%2flocalhost%3a1313%2fpost%2f2024%2f12%2frun-ubuntu-on-mac-with-docker%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Southern</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>